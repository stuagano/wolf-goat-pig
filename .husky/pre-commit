#!/bin/sh
set -e

echo "ğŸ“¦ Verifying package-lock.json is in sync..."
cd frontend
if ! npm ci --dry-run 2>/dev/null; then
  echo "âŒ package-lock.json is out of sync with package.json!"
  echo "   Run 'cd frontend && npm install' to fix."
  exit 1
fi
echo "âœ… package-lock.json is in sync"
cd ..

echo "ğŸ” Running simulation diagnostics (npm test)"
npm test

echo "ğŸš€ Verifying Render-style backend deployment"
./scripts/test-prod-backend.sh

echo "ğŸŒ Verifying Vercel-style frontend deployment"
./scripts/test-prod-frontend.sh
