ðŸŽ¯ ADK auto-sync aliases loaded!
ðŸ’¡ Use 'sync' to sync with upstream anytime
ðŸ’¡ Use 'synccheck' to check sync status
ðŸ§ª Executing Behave feature tests
ðŸ“¦ Ensuring backend test dependencies are available
ðŸš€ Running Behave against tests/bdd/behave
USING RUNNER: behave.runner:Runner
Feature: Simulation betting mechanics # tests/bdd/behave/features/simulation_betting.feature:1
  Wolf Goat Pig betting involves progressive wagering with doubles, carries, and special rules.
  These scenarios exercise the reusable seeding DSL for betting-related state.
  Feature: Simulation betting mechanics  # tests/bdd/behave/features/simulation_betting.feature:1

  Scenario: Seeded double state snapshot      # tests/bdd/behave/features/simulation_betting.feature:9
    Given the simulation API is available     # tests/bdd/behave/steps/simulation_steps.py:42
LOG_WARNING:backend.app.services.email_service: Email service is not fully configured. Check environment variables: SMTP_USER, SMTP_PASSWORD, SMTP_HOST
    And a simulation is set up with 4 players # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 3         # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the ball positions are                # tests/bdd/behave/steps/simulation_steps.py:110
      | player_id | distance_to_pin | lie_type | shot_count |
      | p1        | 180             | fairway  | 1          |
      | bot1      | 150             | fairway  | 1          |
      | bot2      | 200             | rough    | 1          |
      | bot3      | 165             | fairway  | 1          |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                  # tests/bdd/behave/steps/simulation_steps.py:120
      | base_wager    | 1    |
      | current_wager | 2    |
      | doubled       | true |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the betting is doubled               # tests/bdd/behave/steps/simulation_steps.py:430
    And the current wager is 2 quarters       # tests/bdd/behave/steps/simulation_steps.py:438

  Scenario: Line of scrimmage enforcement                 # tests/bdd/behave/features/simulation_betting.feature:24
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players             # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 5                     # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the ball positions are                            # tests/bdd/behave/steps/simulation_steps.py:110
      | player_id | distance_to_pin | lie_type | shot_count |
      | p1        | 250             | rough    | 1          |
      | bot1      | 150             | fairway  | 1          |
      | bot2      | 175             | fairway  | 1          |
      | bot3      | 200             | bunker   | 1          |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the line of scrimmage is p1                       # tests/bdd/behave/steps/simulation_steps.py:183
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I request the "GET" "/simulation/state" endpoint # tests/bdd/behave/steps/simulation_steps.py:241
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the response code is 200                         # tests/bdd/behave/steps/simulation_steps.py:327
    And the JSON response contains                        # tests/bdd/behave/steps/simulation_steps.py:336
      | hole_state.line_of_scrimmage | p1 |

  Scenario: Wagering closes after tee shots   # tests/bdd/behave/features/simulation_betting.feature:38
    Given the simulation API is available     # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 1         # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the ball positions are                # tests/bdd/behave/steps/simulation_steps.py:110
      | player_id | distance_to_pin | lie_type | shot_count |
      | p1        | 180             | fairway  | 1          |
      | bot1      | 160             | fairway  | 1          |
      | bot2      | 190             | fairway  | 1          |
      | bot3      | 170             | fairway  | 1          |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And wagering is set to closed             # tests/bdd/behave/steps/simulation_steps.py:173
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state       # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then wagering is closed                   # tests/bdd/behave/steps/simulation_steps.py:487
    And the simulation state contains         # tests/bdd/behave/steps/simulation_steps.py:351
      | wagering_closed | true |

  Scenario: Carry-over betting state          # tests/bdd/behave/features/simulation_betting.feature:52
    Given the simulation API is available     # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 7         # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                  # tests/bdd/behave/steps/simulation_steps.py:120
      | base_wager    | 1    |
      | current_wager | 4    |
      | carry_over    | true |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state       # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the current wager is 4 quarters      # tests/bdd/behave/steps/simulation_steps.py:438
    And the simulation state contains         # tests/bdd/behave/steps/simulation_steps.py:351
      | betting_state.carry_over | true |

  Scenario: Ping pong counter tracking        # tests/bdd/behave/features/simulation_betting.feature:63
    Given the simulation API is available     # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 10        # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                  # tests/bdd/behave/steps/simulation_steps.py:120
      | base_wager      | 2    |
      | ping_pong_count | 3    |
      | doubled         | true |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state       # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains        # tests/bdd/behave/steps/simulation_steps.py:351
      | betting_state.ping_pong_count | 3    |
      | betting_state.doubled         | true |

  Scenario: Complex betting state with multiple flags  # tests/bdd/behave/features/simulation_betting.feature:74
    Given the simulation API is available              # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players          # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation state is seeded with          # tests/bdd/behave/steps/simulation_steps.py:192
      | current_hole              | 15   |
      | betting.base_wager        | 2    |
      | betting.current_wager     | 8    |
      | betting.doubled           | true |
      | betting.carry_over        | true |
      | betting.float_invoked     | true |
      | betting.line_of_scrimmage | bot2 |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                 # tests/bdd/behave/steps/simulation_steps.py:351
      | current_hole                 | 15   |
      | betting_state.current_wager  | 8    |
      | betting_state.float_invoked  | true |
      | hole_state.line_of_scrimmage | bot2 |

  Scenario: Reject double when wagering is closed  # tests/bdd/behave/features/simulation_betting.feature:90
    Given the simulation API is available          # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players      # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 2              # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the ball positions are                     # tests/bdd/behave/steps/simulation_steps.py:110
      | player_id | distance_to_pin | lie_type | shot_count |
      | p1        | 150             | fairway  | 2          |
      | bot1      | 145             | fairway  | 2          |
      | bot2      | 160             | rough    | 2          |
      | bot3      | 155             | fairway  | 2          |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And wagering is set to closed                  # tests/bdd/behave/steps/simulation_steps.py:173
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                       # tests/bdd/behave/steps/simulation_steps.py:120
      | current_wager | 1     |
      | doubled       | false |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I seed the betting state with             # tests/bdd/behave/steps/simulation_steps.py:120
      | doubled       | true |
      | current_wager | 2    |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains             # tests/bdd/behave/steps/simulation_steps.py:351
      | betting_state.doubled       | true |
      | betting_state.current_wager | 2    |
      | wagering_closed             | true |

  Scenario: Solo captain can double when wagering closed  # tests/bdd/behave/features/simulation_betting.feature:110
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players             # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 4                     # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type        | solo                     |
      | captain     | p1                       |
      | solo_player | p1                       |
      | opponents   | ["bot1", "bot2", "bot3"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And wagering is set to closed                         # tests/bdd/behave/steps/simulation_steps.py:173
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I seed the betting state with                    # tests/bdd/behave/steps/simulation_steps.py:120
      | doubled       | true |
      | current_wager | 2    |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | team_formation.type         | solo |
      | team_formation.solo_player  | p1   |
      | betting_state.doubled       | true |
      | betting_state.current_wager | 2    |

  Scenario: Ping pong counter tracks escalating doubles  # tests/bdd/behave/features/simulation_betting.feature:127
    Given the simulation API is available                # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players            # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 8                    # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the ball positions are                           # tests/bdd/behave/steps/simulation_steps.py:110
      | player_id | distance_to_pin | lie_type | shot_count |
      | p1        | 120             | fairway  | 2          |
      | bot1      | 115             | fairway  | 2          |
      | bot2      | 130             | fairway  | 2          |
      | bot3      | 125             | fairway  | 2          |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                             # tests/bdd/behave/steps/simulation_steps.py:120
      | base_wager      | 1     |
      | current_wager   | 1     |
      | ping_pong_count | 0     |
      | doubled         | false |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I seed the betting state with                   # tests/bdd/behave/steps/simulation_steps.py:120
      | doubled         | true |
      | current_wager   | 2    |
      | ping_pong_count | 1    |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And I refresh the simulation state                   # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                   # tests/bdd/behave/steps/simulation_steps.py:351
      | betting_state.ping_pong_count | 1    |
      | betting_state.doubled         | true |
      | betting_state.current_wager   | 2    |
    When I seed the betting state with                   # tests/bdd/behave/steps/simulation_steps.py:120
      | redoubled       | true |
      | current_wager   | 4    |
      | ping_pong_count | 2    |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                   # tests/bdd/behave/steps/simulation_steps.py:351
      | betting_state.ping_pong_count | 2    |
      | betting_state.redoubled       | true |
      | betting_state.current_wager   | 4    |

  Scenario: Betting with special rules invoked  # tests/bdd/behave/features/simulation_betting.feature:158
    Given the simulation API is available       # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players   # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 12          # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                    # tests/bdd/behave/steps/simulation_steps.py:120
      | base_wager       | 1     |
      | current_wager    | 3     |
      | float_invoked    | true  |
      | option_invoked   | true  |
      | duncan_invoked   | false |
      | tunkarri_invoked | false |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state         # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains          # tests/bdd/behave/steps/simulation_steps.py:351
      | betting_state.current_wager    | 3     |
      | betting_state.float_invoked    | true  |
      | betting_state.option_invoked   | true  |
      | betting_state.duncan_invoked   | false |
      | betting_state.tunkarri_invoked | false |

  Scenario: Carry-over accumulates across holes  # tests/bdd/behave/features/simulation_betting.feature:175
    Given the simulation API is available        # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players    # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 9            # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                     # tests/bdd/behave/steps/simulation_steps.py:120
      | base_wager    | 2     |
      | current_wager | 8     |
      | carry_over    | true  |
      | doubled       | false |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state          # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains           # tests/bdd/behave/steps/simulation_steps.py:351
      | betting_state.carry_over    | true |
      | betting_state.current_wager | 8    |
    When the simulation is moved to hole 10      # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And I seed the betting state with            # tests/bdd/behave/steps/simulation_steps.py:120
      | base_wager    | 2    |
      | current_wager | 10   |
      | carry_over    | true |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains           # tests/bdd/behave/steps/simulation_steps.py:351
      | current_hole                | 10   |
      | betting_state.current_wager | 10   |
      | betting_state.carry_over    | true |

  Scenario: Line of scrimmage affects betting opportunities  # tests/bdd/behave/features/simulation_betting.feature:196
    Given the simulation API is available                    # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players                # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 6                        # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the ball positions are                               # tests/bdd/behave/steps/simulation_steps.py:110
      | player_id | distance_to_pin | lie_type | shot_count |
      | p1        | 200             | rough    | 1          |
      | bot1      | 150             | fairway  | 1          |
      | bot2      | 160             | fairway  | 1          |
      | bot3      | 170             | fairway  | 1          |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the line of scrimmage is p1                          # tests/bdd/behave/steps/simulation_steps.py:183
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                                 # tests/bdd/behave/steps/simulation_steps.py:120
      | current_wager | 1     |
      | doubled       | false |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                      # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                       # tests/bdd/behave/steps/simulation_steps.py:351
      | hole_state.line_of_scrimmage | p1 |
      | betting_state.current_wager  | 1  |

  Scenario: Reset doubles history flag        # tests/bdd/behave/features/simulation_betting.feature:213
    Given the simulation API is available     # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 4 players # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 11        # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                  # tests/bdd/behave/steps/simulation_steps.py:120
      | current_wager | 2    |
      | doubled       | true |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I seed the simulation state with     # tests/bdd/behave/steps/simulation_steps.py:192
      | betting.current_wager | 1     |
      | betting.doubled       | false |
      | reset_doubles_history | true  |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains        # tests/bdd/behave/steps/simulation_steps.py:351
      | betting_state.current_wager | 1     |
      | betting_state.doubled       | false |

Feature: Simulation service health checks # tests/bdd/behave/features/simulation_health.feature:1
  The Wolf Goat Pig platform needs high-level functional signals so stakeholders can express
  expectations in plain English. These Gherkin scenarios can be generated collaboratively with the AI agent
  from conversational requirements and then executed automatically.
  Feature: Simulation service health checks  # tests/bdd/behave/features/simulation_health.feature:1

  Scenario: Health endpoint returns an "ok" status payload  # tests/bdd/behave/features/simulation_health.feature:9
    Given the simulation API is available                   # tests/bdd/behave/steps/simulation_steps.py:42
    When I request the "GET" "health" endpoint              # tests/bdd/behave/steps/simulation_steps.py:241
LOG_ERROR:backend.app.main: AI players availability check failed: (sqlite3.OperationalError) no such table: player_profiles
[SQL: SELECT count(*) AS count_1 
FROM (SELECT player_profiles.id AS player_profiles_id, player_profiles.name AS player_profiles_name, player_profiles.email AS player_profiles_email, player_profiles.handicap AS player_profiles_handicap, player_profiles.ghin_id AS player_profiles_ghin_id, player_profiles.ghin_last_updated AS player_profiles_ghin_last_updated, player_profiles.avatar_url AS player_profiles_avatar_url, player_profiles.created_at AS player_profiles_created_at, player_profiles.updated_at AS player_profiles_updated_at, player_profiles.last_played AS player_profiles_last_played, player_profiles.preferences AS player_profiles_preferences, player_profiles.is_active AS player_profiles_is_active, player_profiles.is_ai AS player_profiles_is_ai, player_profiles.playing_style AS player_profiles_playing_style, player_profiles.description AS player_profiles_description, player_profiles.personality_traits AS player_profiles_personality_traits, player_profiles.strengths AS player_profiles_strengths, player_profiles.weaknesses AS player_profiles_weaknesses 
FROM player_profiles 
WHERE player_profiles.is_ai = ? AND player_profiles.is_active = ?) AS anon_1]
[parameters: (1, 1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
LOG_INFO:backend.app.seed_data: Checking seeding status...
LOG_ERROR:backend.app.seed_data: Error verifying seeded data: (sqlite3.OperationalError) no such table: player_profiles
[SQL: SELECT count(*) AS count_1 
FROM (SELECT player_profiles.id AS player_profiles_id, player_profiles.name AS player_profiles_name, player_profiles.email AS player_profiles_email, player_profiles.handicap AS player_profiles_handicap, player_profiles.ghin_id AS player_profiles_ghin_id, player_profiles.ghin_last_updated AS player_profiles_ghin_last_updated, player_profiles.avatar_url AS player_profiles_avatar_url, player_profiles.created_at AS player_profiles_created_at, player_profiles.updated_at AS player_profiles_updated_at, player_profiles.last_played AS player_profiles_last_played, player_profiles.preferences AS player_profiles_preferences, player_profiles.is_active AS player_profiles_is_active, player_profiles.is_ai AS player_profiles_is_ai, player_profiles.playing_style AS player_profiles_playing_style, player_profiles.description AS player_profiles_description, player_profiles.personality_traits AS player_profiles_personality_traits, player_profiles.strengths AS player_profiles_strengths, player_profiles.weaknesses AS player_profiles_weaknesses 
FROM player_profiles 
WHERE player_profiles.is_ai = ?) AS anon_1]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
LOG_INFO:httpx: HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
    Then the response code is 200                           # tests/bdd/behave/steps/simulation_steps.py:327
    And the JSON response contains:                         # tests/bdd/behave/steps/simulation_steps.py:336
      | status | ok |

  Scenario: Simulation setup rejects requests with fewer than four players  # tests/bdd/behave/features/simulation_health.feature:15
    Given the simulation API is available                                   # tests/bdd/behave/steps/simulation_steps.py:42
    When I submit a simulation setup request with 2 players                 # tests/bdd/behave/steps/simulation_steps.py:287
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_ERROR:backend.app.main: Simulation setup failed: 400: At least 4 players required
LOG_ERROR:backend.app.main: HTTP exception: 500 - Failed to setup simulation: 400: At least 4 players required
LOG_ERROR:backend.app.main: Request Host header: testserver
LOG_ERROR:backend.app.main: Request Client host: testclient
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 500 Internal Server Error"
    Then the response code is 400                                           # tests/bdd/behave/steps/simulation_steps.py:327
      ASSERT FAILED: Expected status 400, got 500: {"error":"HTTP error","detail":"Failed to setup simulation: 400: At least 4 players required"}

    And the JSON response contains:                                         # None
      | detail | Failed to setup simulation: 400: At least 4 players required |
----
CAPTURED LOG: scenario
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_ERROR:backend.app.main: Simulation setup failed: 400: At least 4 players required
LOG_ERROR:backend.app.main: HTTP exception: 500 - Failed to setup simulation: 400: At least 4 players required
LOG_ERROR:backend.app.main: Request Host header: testserver
LOG_ERROR:backend.app.main: Request Client host: testclient
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 500 Internal Server Error"
---- CAPTURED_SCENARIO_OUTPUT_END ----

Feature: Simulation partnership and team formation # tests/bdd/behave/features/simulation_partnership.feature:1
  Wolf Goat Pig involves dynamic team formation with partnership requests, solo play, and captain decisions.
  These scenarios validate team-related helpers supported by the seeding DSL.
  Feature: Simulation partnership and team formation  # tests/bdd/behave/features/simulation_partnership.feature:1

  Scenario: Partnership formation after tee shots         # tests/bdd/behave/features/simulation_partnership.feature:14
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 2                     # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the ball positions are                            # tests/bdd/behave/steps/simulation_steps.py:110
      | player_id | distance_to_pin | lie_type | shot_count |
      | p1        | 175             | fairway  | 1          |
      | bot1      | 160             | fairway  | 1          |
      | bot2      | 195             | rough    | 1          |
      | bot3      | 150             | fairway  | 1          |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type    | partners         |
      | captain | p1               |
      | team1   | ["p1", "bot1"]   |
      | team2   | ["bot2", "bot3"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                   # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then team 1 contains players p1, bot1                 # tests/bdd/behave/steps/simulation_steps.py:458
    And team 2 contains players bot2, bot3                # tests/bdd/behave/steps/simulation_steps.py:467

  Scenario: Captain goes solo                             # tests/bdd/behave/features/simulation_partnership.feature:31
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 4                     # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type        | solo                     |
      | solo_player | p1                       |
      | opponents   | ["bot1", "bot2", "bot3"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                   # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the simulation state contains                     # tests/bdd/behave/steps/simulation_steps.py:351
      | team_formation.type        | solo |
      | team_formation.solo_player | p1   |

  Scenario: Rotating captain order                        # tests/bdd/behave/features/simulation_partnership.feature:42
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 5                     # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the next player to hit is bot1                    # tests/bdd/behave/steps/simulation_steps.py:101
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type    | pending |
      | captain | bot1    |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                   # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | team_formation.captain | bot1    |
      | team_formation.type    | pending |

  Scenario: Aardvark toss setup in 5-player game          # tests/bdd/behave/features/simulation_partnership.feature:53
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 5 players             # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the simulation is at hole 3                       # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type    | partners         |
      | captain | p1               |
      | team1   | ["p1", "bot2"]   |
      | team2   | ["bot1", "bot3"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                   # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"

  Scenario: Pending partnership request snapshot          # tests/bdd/behave/features/simulation_partnership.feature:64
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation state is seeded with             # tests/bdd/behave/steps/simulation_steps.py:192
      | current_hole           | 8       |
      | next_player_to_hit     | bot2    |
      | team_formation.type    | pending |
      | team_formation.captain | bot2    |
      | wagering_closed        | false   |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                   # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | current_hole           | 8       |
      | team_formation.type    | pending |
      | team_formation.captain | bot2    |

  Scenario: Team formation affects betting opportunities  # tests/bdd/behave/features/simulation_partnership.feature:77
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 6                     # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type    | partners         |
      | captain | bot3             |
      | team1   | ["bot3", "p1"]   |
      | team2   | ["bot1", "bot2"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                              # tests/bdd/behave/steps/simulation_steps.py:120
      | base_wager    | 2     |
      | current_wager | 2     |
      | doubled       | false |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I request the "GET" "/simulation/state" endpoint # tests/bdd/behave/steps/simulation_steps.py:241
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the response code is 200                         # tests/bdd/behave/steps/simulation_steps.py:327
    And the JSON response contains                        # tests/bdd/behave/steps/simulation_steps.py:336
      | hole_state.teams.type            | partners |
      | hole_state.betting.current_wager | 2        |

  Scenario: Pending partnership request acceptance        # tests/bdd/behave/features/simulation_partnership.feature:94
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 7                     # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the ball positions are                            # tests/bdd/behave/steps/simulation_steps.py:110
      | player_id | distance_to_pin | lie_type | shot_count |
      | p1        | 155             | fairway  | 1          |
      | bot1      | 160             | fairway  | 1          |
      | bot2      | 150             | fairway  | 1          |
      | bot3      | 165             | rough    | 1          |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type            | pending                                                     |
      | captain         | p1                                                          |
      | pending_request | {"captain": "p1", "requested": "bot2", "status": "pending"} |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                   # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | team_formation.type                      | pending |
      | team_formation.pending_request.status    | pending |
      | team_formation.pending_request.requested | bot2    |
    When I seed the team formation with                   # tests/bdd/behave/steps/simulation_steps.py:147
      | type    | partners         |
      | captain | p1               |
      | team1   | ["p1", "bot2"]   |
      | team2   | ["bot1", "bot3"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then team 1 contains players p1, bot2                 # tests/bdd/behave/steps/simulation_steps.py:458
    And team 2 contains players bot1, bot3                # tests/bdd/behave/steps/simulation_steps.py:467

  Scenario: Pending partnership request decline           # tests/bdd/behave/features/simulation_partnership.feature:119
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 9                     # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the ball positions are                            # tests/bdd/behave/steps/simulation_steps.py:110
      | player_id | distance_to_pin | lie_type | shot_count |
      | p1        | 140             | fairway  | 1          |
      | bot1      | 145             | fairway  | 1          |
      | bot2      | 135             | fairway  | 1          |
      | bot3      | 150             | rough    | 1          |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type            | pending                                                       |
      | captain         | bot1                                                          |
      | pending_request | {"captain": "bot1", "requested": "bot3", "status": "pending"} |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I seed the team formation with                   # tests/bdd/behave/steps/simulation_steps.py:147
      | type        | solo                   |
      | captain     | bot1                   |
      | solo_player | bot1                   |
      | opponents   | ["p1", "bot2", "bot3"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | team_formation.type        | solo |
      | team_formation.solo_player | bot1 |

  Scenario: Solo captain doubles after wagering closed    # tests/bdd/behave/features/simulation_partnership.feature:140
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 11                    # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the ball positions are                            # tests/bdd/behave/steps/simulation_steps.py:110
      | player_id | distance_to_pin | lie_type | shot_count |
      | p1        | 100             | fairway  | 2          |
      | bot1      | 95              | green    | 2          |
      | bot2      | 110             | fairway  | 2          |
      | bot3      | 105             | fairway  | 2          |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type        | solo                   |
      | captain     | bot2                   |
      | solo_player | bot2                   |
      | opponents   | ["p1", "bot1", "bot3"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And wagering is set to closed                         # tests/bdd/behave/steps/simulation_steps.py:173
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the betting state is                              # tests/bdd/behave/steps/simulation_steps.py:120
      | current_wager | 2    |
      | doubled       | true |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                   # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | team_formation.type         | solo |
      | team_formation.solo_player  | bot2 |
      | wagering_closed             | true |
      | betting_state.doubled       | true |
      | betting_state.current_wager | 2    |

  Scenario: Complex team transitions across holes         # tests/bdd/behave/features/simulation_partnership.feature:165
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 13                    # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type    | partners         |
      | captain | p1               |
      | team1   | ["p1", "bot3"]   |
      | team2   | ["bot1", "bot2"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                   # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the teams are formed as partners                 # tests/bdd/behave/steps/simulation_steps.py:448
    When the simulation is moved to hole 14               # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And I seed the team formation with                    # tests/bdd/behave/steps/simulation_steps.py:147
      | type    | pending |
      | captain | bot1    |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | current_hole           | 14      |
      | team_formation.type    | pending |
      | team_formation.captain | bot1    |
    When I seed the team formation with                   # tests/bdd/behave/steps/simulation_steps.py:147
      | type        | solo                   |
      | captain     | bot1                   |
      | solo_player | bot1                   |
      | opponents   | ["p1", "bot2", "bot3"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then player "bot1" is going solo                      # tests/bdd/behave/steps/simulation_steps.py:476

  Scenario: Multiple captains in larger games             # tests/bdd/behave/features/simulation_partnership.feature:189
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with 6 players             # tests/bdd/behave/steps/simulation_steps.py:50
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the simulation is at hole 15                      # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type           | partners                 |
      | captain        | p1                       |
      | second_captain | bot3                     |
      | team1          | ["p1", "bot1", "bot2"]   |
      | team2          | ["bot3", "bot4", "bot5"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I refresh the simulation state                   # tests/bdd/behave/steps/simulation_steps.py:315
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | team_formation.type           | partners |
      | team_formation.captain        | p1       |
      | team_formation.second_captain | bot3     |
      ASSERT FAILED: Expected state.team_formation.second_captain to be 'bot3' but got 'null'

----
CAPTURED LOG: scenario
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
---- CAPTURED_SCENARIO_OUTPUT_END ----

  Scenario: Partnership request with invalid player       # tests/bdd/behave/features/simulation_partnership.feature:205
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 10                    # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I seed the team formation with                   # tests/bdd/behave/steps/simulation_steps.py:147
      | type            | pending                                                               |
      | captain         | p1                                                                    |
      | pending_request | {"captain": "p1", "requested": "invalid_player", "status": "pending"} |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | team_formation.type                      | pending        |
      | team_formation.pending_request.requested | invalid_player |

  Scenario: Team formation reset between holes            # tests/bdd/behave/features/simulation_partnership.feature:215
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 16                    # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the team formation is                             # tests/bdd/behave/steps/simulation_steps.py:147
      | type    | partners         |
      | captain | bot2             |
      | team1   | ["bot2", "p1"]   |
      | team2   | ["bot1", "bot3"] |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When the simulation is moved to hole 17               # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And I seed the team formation with                    # tests/bdd/behave/steps/simulation_steps.py:147
      | type    | pending |
      | captain | bot3    |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | current_hole           | 17      |
      | team_formation.type    | pending |
      | team_formation.captain | bot3    |

  Scenario: Captain rotation tracking                     # tests/bdd/behave/features/simulation_partnership.feature:231
    Given the simulation API is available                 # tests/bdd/behave/steps/simulation_steps.py:42
    And a simulation is set up with the following players # tests/bdd/behave/steps/simulation_steps.py:75
      | id   | name       | handicap | is_human |
      | p1   | Captain    | 10       | true     |
      | bot1 | Computer 1 | 12       | false    |
      | bot2 | Computer 2 | 14       | false    |
      | bot3 | Computer 3 | 8        | false    |
LOG_INFO:backend.app.main: Setting up new simulation...
LOG_INFO:backend.app.main: Simulation setup completed successfully
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/setup "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Given the simulation is at hole 18                    # tests/bdd/behave/steps/simulation_steps.py:92
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    And the next player to hit is bot3                    # tests/bdd/behave/steps/simulation_steps.py:101
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    When I seed the team formation with                   # tests/bdd/behave/steps/simulation_steps.py:147
      | type    | pending |
      | captain | bot3    |
LOG_INFO:httpx: HTTP Request: POST http://testserver/simulation/test/seed-state "HTTP/1.1 200 OK"
LOG_INFO:httpx: HTTP Request: GET http://testserver/simulation/state "HTTP/1.1 200 OK"
    Then the simulation state contains                    # tests/bdd/behave/steps/simulation_steps.py:351
      | next_player_to_hit     | bot3    |
      | team_formation.captain | bot3    |
      | team_formation.type    | pending |


Failing scenarios:
  tests/bdd/behave/features/simulation_health.feature:15  Simulation setup rejects requests with fewer than four players
  tests/bdd/behave/features/simulation_partnership.feature:189  Multiple captains in larger games

1 feature passed, 2 failed, 0 skipped
27 scenarios passed, 2 failed, 0 skipped
204 steps passed, 2 failed, 1 skipped
Took 0min 0.833s
